<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Comments</title>
</head>
<body>
    <h1>Comments</h1>
    <form id="commentForm">
        <input type="text" name="name" placeholder="Your name" required>
        <textarea name="comment" placeholder="Your comment" required></textarea>
        <button type="submit">Submit</button>
    </form>
    <ul id="commentsList">
        {% for comment in comments %}
            <li><strong>{{ comment.name }}</strong>: {{ comment.comment }}</li>
        {% endfor %}
    </ul>

    <script>
        document.getElementById('commentForm').onsubmit = async function(event) {
            event.preventDefault();
            const formData = new FormData(this);
            const jsonData = JSON.stringify(Object.fromEntries(formData.entries()));
            const response = await fetch('/comments/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: jsonData
            });
            if (response.ok) {
                const newComment = await response.json();
                const newCommentItem = document.createElement('li');
                newCommentItem.innerHTML = `<strong>${newComment.name}</strong>: ${newComment.comment}`;
                document.getElementById('commentsList').appendChild(newCommentItem);
                this.reset();
            }
        };
    </script>
</body>
</html>

